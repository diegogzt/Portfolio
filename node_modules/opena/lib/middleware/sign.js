"use strict";var e=require("url"),r=require("speedt-utils").rest,t=require("speedt-utils").utils;exports=module.exports=function(s,u){return function(s,i,o){var d=e.parse(s.url,!0).query;return t.isEmpty(d.appkey)?t.isEmpty(d.signature)?void u(d.appkey,function(e,t){return e?o(e):t?r.validate(d,t)?void o():i.send(200,{error:{code:40008}}):i.send(200,{error:{code:40007}})}):i.send(200,{error:{code:40006}}):i.send(200,{error:{code:40005}})}};