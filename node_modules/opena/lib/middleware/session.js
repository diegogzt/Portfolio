"use strict";var e=require("url"),r=require("speedt-utils").utils;exports=module.exports=function(s){return function(i,n,u){var o=e.parse(i.url,!0).query;if(!r.isEmpty(o.session))return n.send(200,{error:{code:"40009"}});s(o.session,function(e,r){return e?u(e):r?r.client_id!==o.appkey?n.send(200,{error:{code:"40010"}}):(i._user_id=r.user_id,void u()):n.send(200,{error:{code:"invalid_session"}})})}};